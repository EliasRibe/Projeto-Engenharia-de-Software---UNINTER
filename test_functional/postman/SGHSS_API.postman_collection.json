{
  "info": { "name": "SGHSS API", "_postman_id": "sghss-api", "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json" },
  "item": [
    {
      "name": "CT001 - Criar paciente (válido)",
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "url": "{{baseUrl}}/patients",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"nome\": \"Paciente QA\",\n  \"email\": \"qa@vida.plus\",\n  \"cpf\": \"12345678901\",\n  \"consentimentoLGPD\": true\n}"
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('status 201', function () { pm.response.to.have.status(201); });",
            "pm.test('retorna id e consentimento', function () {",
            " const json = pm.response.json();",
            " pm.expect(json).to.have.property('id');",
            " pm.expect(json.consentimentoLGPD).to.eql(true);",
            "});"
          ],
          "type": "text/javascript"
        }
      }]
    },
    {
      "name": "CT002 - Bloquear CPF inválido",
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "url": "{{baseUrl}}/patients",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"nome\": \"Paciente QA\",\n  \"email\": \"qa@vida.plus\",\n  \"cpf\": \"111\",\n  \"consentimentoLGPD\": true\n}"
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('status 400', function () { pm.response.to.have.status(400); });",
            "pm.test('mensagem de erro', function () {",
            " const json = pm.response.json();",
            " pm.expect(json.error).to.match(/CPF inválido/i);",
            "});"
          ],
          "type": "text/javascript"
        }
      }]
    }
  ],
  "variable": [{ "key": "baseUrl", "value": "http://localhost:3000" }]
}
